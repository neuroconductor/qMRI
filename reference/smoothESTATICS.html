<!-- Generated by pkgdown: do not edit by hand -->
<!DOCTYPE html>
<html lang="en">
  <head>
  <meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<title>Adaptive smoothing of ESTATICS parameters and MPM data — smoothESTATICS • qMRI</title>


<!-- jquery -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script>
<!-- Bootstrap -->

<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous" />

<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script>

<!-- bootstrap-toc -->
<link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script>

<!-- Font Awesome icons -->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous" />
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous" />

<!-- clipboard.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script>

<!-- headroom.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script>

<!-- pkgdown -->
<link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script>




<meta property="og:title" content="Adaptive smoothing of ESTATICS parameters and MPM data — smoothESTATICS" />
<meta property="og:description" content="Performs adaptive smoothing of parameter maps in the ESTATICS model and if
mpmData is specified these data. Implements both vectorized variants of the
Adaptive Weights Smoothing (AWS, Polzehl and Spokoiny (2006))
and patchwise AWS (PAWS, Polzehl et al (2018)) algorithms with weighting schemes determined by
the estimated parameter maps and their covariances." />






<!-- mathjax -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script>

<!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->




  

  

  </head>

  <body data-spy="scroll" data-target="#toc">
    

    <div class="container template-reference-topic">
      <header>
      <div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">qMRI</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">1.2</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="../reference/index.html">Reference</a>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        
      </ul>
      
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header>

<div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Adaptive smoothing of ESTATICS parameters and MPM data</h1>
    
    <div class="hidden name"><code>smoothESTATICS.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>Performs adaptive smoothing of parameter maps in the ESTATICS model and if
<code>mpmData</code> is specified these data. Implements both vectorized variants of the
Adaptive Weights Smoothing (AWS, Polzehl and Spokoiny (2006))
and patchwise AWS (PAWS, Polzehl et al (2018)) algorithms with weighting schemes determined by
the estimated parameter maps and their covariances.</p>
    </div>

    <div class="ref-usage sourceCode"><pre class='sourceCode r'><code><span class='fu'>smoothESTATICS</span><span class='op'>(</span><span class='va'>mpmESTATICSModel</span>, mpmData <span class='op'>=</span> <span class='cn'>NULL</span>, kstar <span class='op'>=</span> <span class='fl'>16</span>, alpha <span class='op'>=</span> <span class='fl'>0.025</span>,
               patchsize <span class='op'>=</span> <span class='fl'>0</span>, wghts <span class='op'>=</span> <span class='cn'>NULL</span>, verbose <span class='op'>=</span> <span class='cn'>TRUE</span><span class='op'>)</span></code></pre></div>

    <h2 class="hasAnchor" id="arguments"><a class="anchor" href="#arguments"></a>Arguments</h2>
    <table class="ref-arguments">
    <colgroup><col class="name" /><col class="desc" /></colgroup>
    <tr>
      <th>mpmESTATICSModel</th>
      <td><p>Object of class 'ESTATICSModel' as returned from function <code><a href='estimateESTATICS.html'>estimateESTATICS</a></code>.</p></td>
    </tr>
    <tr>
      <th>mpmData</th>
      <td><p>(optional) Object of class MPMData as created by <code><a href='readMPMData.html'>readMPMData</a></code> from which
the parameter maps were obtained.</p></td>
    </tr>
    <tr>
      <th>kstar</th>
      <td><p>Maximum number of steps.</p></td>
    </tr>
    <tr>
      <th>alpha</th>
      <td><p>specifies the scale parameter for the adaptation criterion. smaller values are more restrictive.</p></td>
    </tr>
    <tr>
      <th>patchsize</th>
      <td><p>Patchsize in PAWS, 0 corresponds to AWS, alternative values are 1 and 2.</p></td>
    </tr>
    <tr>
      <th>wghts</th>
      <td><p>(optional) voxel size if measurments are not isotropic.</p></td>
    </tr>
    <tr>
      <th>verbose</th>
      <td><p>logical - provide information on progress</p></td>
    </tr>
    </table>

    <h2 class="hasAnchor" id="value"><a class="anchor" href="#value"></a>Value</h2>

    <p>list with components</p>
<dt>modelCoeff </dt><dd><p>Estimated parameter maps</p></dd>
                 <dt>invCov </dt><dd><p>map of inverse covariance matrices</p></dd>
                 <dt>isConv </dt><dd><p>convergence indicator map</p></dd>
                 <dt>bi</dt><dd><p>Sum of weights map from AWS/PAWS</p></dd>
                 <dt>smoothPar</dt><dd><p>smooting parameters used in AWS/PAWS</p></dd>
                 <dt>smoothedData</dt><dd><p>smoothed mpmData</p></dd>
                 <dt>sdim </dt><dd><p>image dimension</p></dd>
                 <dt>nFiles </dt><dd><p>number of images</p></dd>
                 <dt>t1Files </dt><dd><p>vector of T1 filenames</p></dd>
                 <dt>pdFiles </dt><dd><p>vector of PD filenames</p></dd>
                 <dt>mtFiles </dt><dd><p>vector of MT filenames</p></dd>
                 <dt>model </dt><dd><p>model used (depends on specification of MT files)</p></dd>
                 <dt>maskFile </dt><dd><p>filename of brain mask</p></dd>
                 <dt>mask </dt><dd><p>brain mask</p></dd>
                 <dt>sigma </dt><dd><p>sigma</p></dd>
                 <dt>L </dt><dd><p>L</p></dd>
                 <dt>TR </dt><dd><p>TR values</p></dd>
                 <dt>TE </dt><dd><p>TE values</p></dd>
                 <dt>FA </dt><dd><p>Flip angles (FA)</p></dd>
                 <dt>TEScale </dt><dd><p>TEScale</p></dd>
                 <dt>dataScale </dt><dd><p>dataScale</p></dd>
and class-attribute 'sESTATICSModel'

    <h2 class="hasAnchor" id="references"><a class="anchor" href="#references"></a>References</h2>

    <p>J. Polzehl, V. Spokoiny,  Propagation-separation approach for local likelihood estimation,  Probab. Theory Related Fields  135 (3),  (2006)  , pp. 335--362.</p>
<p>J. Polzehl, K. Papafitsorus, K. Tabelow (2018). Patch-wise adaptive weights smoothing. WIAS-Preprint 2520.</p>
<p>J. Polzehl, K. Tabelow (2019). Magnetic Resonance Brain Imaging:
Modeling and Data Analysis Using R. Springer, Use R! series. Doi:10.1007/978-3-030-29184-6.</p>
    <h2 class="hasAnchor" id="author"><a class="anchor" href="#author"></a>Author</h2>

    <p>Karsten Tabelow <a href='mailto:tabelow@wias-berlin.de'>tabelow@wias-berlin.de</a><br />
J\"org Polzehl <a href='mailto:polzehl@wias-berlin.de'>polzehl@wias-berlin.de</a></p>
    <h2 class="hasAnchor" id="see-also"><a class="anchor" href="#see-also"></a>See also</h2>

    <div class='dont-index'><p><code><a href='readMPMData.html'>readMPMData</a></code>, <code><a href='estimateESTATICS.html'>estimateESTATICS</a></code></p></div>

    <h2 class="hasAnchor" id="examples"><a class="anchor" href="#examples"></a>Examples</h2>
    <div class="ref-examples sourceCode"><pre class='sourceCode r'><code><span class='r-in'><span class='co'># \donttest{</span></span>
<span class='r-in'><span class='va'>dataDir</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/system.file.html'>system.file</a></span><span class='op'>(</span><span class='st'>"extdata"</span>,package<span class='op'>=</span><span class='st'>"qMRI"</span><span class='op'>)</span></span>
<span class='r-in'><span class='co'>#</span></span>
<span class='r-in'><span class='co'>#  set file names for T1w, MTw and PDw images</span></span>
<span class='r-in'><span class='co'>#</span></span>
<span class='r-in'><span class='va'>t1Names</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/paste.html'>paste0</a></span><span class='op'>(</span><span class='st'>"t1w_"</span>,<span class='fl'>1</span><span class='op'>:</span><span class='fl'>8</span>,<span class='st'>".nii.gz"</span><span class='op'>)</span></span>
<span class='r-in'><span class='va'>mtNames</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/paste.html'>paste0</a></span><span class='op'>(</span><span class='st'>"mtw_"</span>,<span class='fl'>1</span><span class='op'>:</span><span class='fl'>6</span>,<span class='st'>".nii.gz"</span><span class='op'>)</span></span>
<span class='r-in'><span class='va'>pdNames</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/paste.html'>paste0</a></span><span class='op'>(</span><span class='st'>"pdw_"</span>,<span class='fl'>1</span><span class='op'>:</span><span class='fl'>8</span>,<span class='st'>".nii.gz"</span><span class='op'>)</span></span>
<span class='r-in'><span class='va'>t1Files</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/file.path.html'>file.path</a></span><span class='op'>(</span><span class='va'>dataDir</span>, <span class='va'>t1Names</span><span class='op'>)</span></span>
<span class='r-in'><span class='va'>mtFiles</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/file.path.html'>file.path</a></span><span class='op'>(</span><span class='va'>dataDir</span>, <span class='va'>mtNames</span><span class='op'>)</span></span>
<span class='r-in'><span class='va'>pdFiles</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/file.path.html'>file.path</a></span><span class='op'>(</span><span class='va'>dataDir</span>, <span class='va'>pdNames</span><span class='op'>)</span></span>
<span class='r-in'><span class='co'>#</span></span>
<span class='r-in'><span class='co'>#  file names of mask and B1 field map</span></span>
<span class='r-in'><span class='co'>#</span></span>
<span class='r-in'><span class='va'>B1File</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/file.path.html'>file.path</a></span><span class='op'>(</span><span class='va'>dataDir</span>, <span class='st'>"B1map.nii.gz"</span><span class='op'>)</span></span>
<span class='r-in'><span class='va'>maskFile</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/file.path.html'>file.path</a></span><span class='op'>(</span><span class='va'>dataDir</span>, <span class='st'>"mask.nii.gz"</span><span class='op'>)</span></span>
<span class='r-in'><span class='co'>#</span></span>
<span class='r-in'><span class='co'>#  Acquisition parameters (TE, TR, Flip Angle) for T1w, MTw and PDw images</span></span>
<span class='r-in'><span class='co'>#</span></span>
<span class='r-in'><span class='va'>TE</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>2.3</span>, <span class='fl'>4.6</span>, <span class='fl'>6.9</span>, <span class='fl'>9.2</span>, <span class='fl'>11.5</span>, <span class='fl'>13.8</span>, <span class='fl'>16.1</span>, <span class='fl'>18.4</span>,</span>
<span class='r-in'>        <span class='fl'>2.3</span>, <span class='fl'>4.6</span>, <span class='fl'>6.9</span>, <span class='fl'>9.2</span>, <span class='fl'>11.5</span>, <span class='fl'>13.8</span>,</span>
<span class='r-in'>        <span class='fl'>2.3</span>, <span class='fl'>4.6</span>, <span class='fl'>6.9</span>, <span class='fl'>9.2</span>, <span class='fl'>11.5</span>, <span class='fl'>13.8</span>, <span class='fl'>16.1</span>, <span class='fl'>18.4</span><span class='op'>)</span></span>
<span class='r-in'><span class='va'>TR</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/rep.html'>rep</a></span><span class='op'>(</span><span class='fl'>25</span>, <span class='fl'>22</span><span class='op'>)</span></span>
<span class='r-in'><span class='va'>FA</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/rep.html'>rep</a></span><span class='op'>(</span><span class='fl'>21</span>, <span class='fl'>8</span><span class='op'>)</span>, <span class='fu'><a href='https://rdrr.io/r/base/rep.html'>rep</a></span><span class='op'>(</span><span class='fl'>6</span>, <span class='fl'>6</span><span class='op'>)</span>, <span class='fu'><a href='https://rdrr.io/r/base/rep.html'>rep</a></span><span class='op'>(</span><span class='fl'>6</span>, <span class='fl'>8</span><span class='op'>)</span><span class='op'>)</span></span>
<span class='r-in'><span class='co'>#</span></span>
<span class='r-in'><span class='co'>#   read MPM example data</span></span>
<span class='r-in'><span class='co'>#</span></span>
<span class='r-in'><span class='kw'><a href='https://rdrr.io/r/base/library.html'>library</a></span><span class='op'>(</span><span class='va'><a href='http://www.wias-berlin.de/research/ats/imaging/'>qMRI</a></span><span class='op'>)</span></span>
<span class='r-in'><span class='va'>mpm</span> <span class='op'>&lt;-</span> <span class='fu'><a href='readMPMData.html'>readMPMData</a></span><span class='op'>(</span><span class='va'>t1Files</span>, <span class='va'>pdFiles</span>, <span class='va'>mtFiles</span>,</span>
<span class='r-in'>                   <span class='va'>maskFile</span>, TR <span class='op'>=</span> <span class='va'>TR</span>, TE <span class='op'>=</span> <span class='va'>TE</span>,</span>
<span class='r-in'>                   FA <span class='op'>=</span> <span class='va'>FA</span>, verbose <span class='op'>=</span> <span class='cn'>FALSE</span><span class='op'>)</span></span>
<span class='r-in'><span class='co'>#</span></span>
<span class='r-in'><span class='co'>#  Estimate Parameters in the ESTATICS model</span></span>
<span class='r-in'><span class='co'>#</span></span>
<span class='r-in'><span class='va'>modelMPM</span> <span class='op'>&lt;-</span> <span class='fu'><a href='estimateESTATICS.html'>estimateESTATICS</a></span><span class='op'>(</span><span class='va'>mpm</span>, method <span class='op'>=</span> <span class='st'>"NLR"</span><span class='op'>)</span></span>
<span class='r-out co'><span class='r-pr'>#&gt;</span> Design of the model:</span>
<span class='r-out co'><span class='r-pr'>#&gt;</span>       [,1] [,2] [,3]  [,4]</span>
<span class='r-out co'><span class='r-pr'>#&gt;</span>  [1,]    1    0    0 0.023</span>
<span class='r-out co'><span class='r-pr'>#&gt;</span>  [2,]    1    0    0 0.046</span>
<span class='r-out co'><span class='r-pr'>#&gt;</span>  [3,]    1    0    0 0.069</span>
<span class='r-out co'><span class='r-pr'>#&gt;</span>  [4,]    1    0    0 0.092</span>
<span class='r-out co'><span class='r-pr'>#&gt;</span>  [5,]    1    0    0 0.115</span>
<span class='r-out co'><span class='r-pr'>#&gt;</span>  [6,]    1    0    0 0.138</span>
<span class='r-out co'><span class='r-pr'>#&gt;</span>  [7,]    1    0    0 0.161</span>
<span class='r-out co'><span class='r-pr'>#&gt;</span>  [8,]    1    0    0 0.184</span>
<span class='r-out co'><span class='r-pr'>#&gt;</span>  [9,]    0    1    0 0.023</span>
<span class='r-out co'><span class='r-pr'>#&gt;</span> [10,]    0    1    0 0.046</span>
<span class='r-out co'><span class='r-pr'>#&gt;</span> [11,]    0    1    0 0.069</span>
<span class='r-out co'><span class='r-pr'>#&gt;</span> [12,]    0    1    0 0.092</span>
<span class='r-out co'><span class='r-pr'>#&gt;</span> [13,]    0    1    0 0.115</span>
<span class='r-out co'><span class='r-pr'>#&gt;</span> [14,]    0    1    0 0.138</span>
<span class='r-out co'><span class='r-pr'>#&gt;</span> [15,]    0    0    1 0.023</span>
<span class='r-out co'><span class='r-pr'>#&gt;</span> [16,]    0    0    1 0.046</span>
<span class='r-out co'><span class='r-pr'>#&gt;</span> [17,]    0    0    1 0.069</span>
<span class='r-out co'><span class='r-pr'>#&gt;</span> [18,]    0    0    1 0.092</span>
<span class='r-out co'><span class='r-pr'>#&gt;</span> [19,]    0    0    1 0.115</span>
<span class='r-out co'><span class='r-pr'>#&gt;</span> [20,]    0    0    1 0.138</span>
<span class='r-out co'><span class='r-pr'>#&gt;</span> [21,]    0    0    1 0.161</span>
<span class='r-out co'><span class='r-pr'>#&gt;</span> [22,]    0    0    1 0.184</span>
<span class='r-out co'><span class='r-pr'>#&gt;</span>  done</span>
<span class='r-out co'><span class='r-pr'>#&gt;</span> Start estimation in 11200 voxel at 2021-05-17 15:22:50 </span>
<span class='r-out co'><span class='r-pr'>#&gt;</span>   |                                                                              |                                                                      |   0%  |                                                                              |======                                                                |   9%  |                                                                              |============                                                          |  18%  |                                                                              |===================                                                   |  27%  |                                                                              |=========================                                             |  36%  |                                                                              |===============================                                       |  45%  |                                                                              |======================================                                |  54%  |                                                                              |============================================                          |  62%  |                                                                              |==================================================                    |  71%  |                                                                              |========================================================              |  80%  |                                                                              |==============================================================        |  89%  |                                                                              |===================================================================== |  98%</span>
<span class='r-out co'><span class='r-pr'>#&gt;</span> Finished estimation 2021-05-17 15:23:10 </span>
<span class='r-in'><span class='co'>#</span></span>
<span class='r-in'><span class='co'>#  smooth maps of ESTATICS Parameters</span></span>
<span class='r-in'><span class='co'>#</span></span>
<span class='r-in'><span class='fu'><a href='https://rdrr.io/pkg/awsMethods/man/setCores.html'>setCores</a></span><span class='op'>(</span><span class='fl'>2</span><span class='op'>)</span></span>
<span class='r-out co'><span class='r-pr'>#&gt;</span>   Total CPU cores available: 2  CPU cores in use: 2.</span>
<span class='r-in'><span class='va'>modelMPMsp1</span> <span class='op'>&lt;-</span> <span class='fu'>smoothESTATICS</span><span class='op'>(</span><span class='va'>modelMPM</span>,</span>
<span class='r-in'>                              kstar <span class='op'>=</span> <span class='fl'>16</span>,</span>
<span class='r-in'>                              alpha <span class='op'>=</span> <span class='fl'>0.004</span>,</span>
<span class='r-in'>                              patchsize<span class='op'>=</span><span class='fl'>1</span>,</span>
<span class='r-in'>                              verbose <span class='op'>=</span> <span class='cn'>TRUE</span><span class='op'>)</span></span>
<span class='r-out co'><span class='r-pr'>#&gt;</span> using lambda= 125.0501  patchsize= 1 </span>
<span class='r-out co'><span class='r-pr'>#&gt;</span> Progress:step 1 hakt 1.010096 time 2021-05-17 15:23:10 </span>
<span class='r-out co'><span class='r-pr'>#&gt;</span> 0.72%  mean(bi) 1.11  step 2 hakt 1.022114 time 2021-05-17 15:23:10 </span>
<span class='r-out co'><span class='r-pr'>#&gt;</span> 1.6%  mean(bi) 1.19  step 3 hakt 1.036736 time 2021-05-17 15:23:10 </span>
<span class='r-out co'><span class='r-pr'>#&gt;</span> 2.8%  mean(bi) 1.31  step 4 hakt 1.055091 time 2021-05-17 15:23:10 </span>
<span class='r-out co'><span class='r-pr'>#&gt;</span> 4.2%  mean(bi) 1.46  step 5 hakt 1.079247 time 2021-05-17 15:23:10 </span>
<span class='r-out co'><span class='r-pr'>#&gt;</span> 5.9%  mean(bi) 1.66  step 6 hakt 1.113579 time 2021-05-17 15:23:11 </span>
<span class='r-out co'><span class='r-pr'>#&gt;</span> 8.2%  mean(bi) 1.91  step 7 hakt 1.169869 time 2021-05-17 15:23:11 </span>
<span class='r-out co'><span class='r-pr'>#&gt;</span> 11%  mean(bi) 2.28  step 8 hakt 1.301844 time 2021-05-17 15:23:11 </span>
<span class='r-out co'><span class='r-pr'>#&gt;</span> 14%  mean(bi) 2.96  step 9 hakt 1.432987 time 2021-05-17 15:23:11 </span>
<span class='r-out co'><span class='r-pr'>#&gt;</span> 19%  mean(bi) 3.62  step 10 hakt 1.46909 time 2021-05-17 15:23:11 </span>
<span class='r-out co'><span class='r-pr'>#&gt;</span> 24%  mean(bi) 4.03  step 11 hakt 1.523812 time 2021-05-17 15:23:11 </span>
<span class='r-out co'><span class='r-pr'>#&gt;</span> 31%  mean(bi) 4.62  step 12 hakt 1.627073 time 2021-05-17 15:23:11 </span>
<span class='r-out co'><span class='r-pr'>#&gt;</span> 39%  mean(bi) 5.54  step 13 hakt 1.781336 time 2021-05-17 15:23:12 </span>
<span class='r-out co'><span class='r-pr'>#&gt;</span> 50%  mean(bi) 6.7  step 14 hakt 1.97111 time 2021-05-17 15:23:12 </span>
<span class='r-out co'><span class='r-pr'>#&gt;</span> 63%  mean(bi) 7.99  step 15 hakt 2.236947 time 2021-05-17 15:23:12 </span>
<span class='r-out co'><span class='r-pr'>#&gt;</span> 79%  mean(bi) 9.43  step 16 hakt 2.333957 time 2021-05-17 15:23:12 </span>
<span class='r-out co'><span class='r-pr'>#&gt;</span> 100%  mean(bi) 9.88  </span>
<span class='r-in'><span class='co'>#</span></span>
<span class='r-in'><span class='co'>#  resulting ESTATICS parameter maps for central coronal slice</span></span>
<span class='r-in'><span class='co'>#</span></span>
<span class='r-in'><span class='kw'>if</span><span class='op'>(</span><span class='kw'><a href='https://rdrr.io/r/base/library.html'>require</a></span><span class='op'>(</span><span class='va'><a href='http://www.wias-berlin.de/software/imaging/'>adimpro</a></span><span class='op'>)</span><span class='op'>)</span><span class='op'>{</span></span>
<span class='r-in'><span class='fu'><a href='https://rdrr.io/pkg/adimpro/man/rimage.html'>rimage.options</a></span><span class='op'>(</span>zquantiles<span class='op'>=</span><span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>.01</span>,<span class='fl'>.99</span><span class='op'>)</span>, ylab<span class='op'>=</span><span class='st'>"z"</span><span class='op'>)</span></span>
<span class='r-in'><span class='va'>oldpar</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/graphics/par.html'>par</a></span><span class='op'>(</span>mfrow<span class='op'>=</span><span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>2</span>,<span class='fl'>4</span><span class='op'>)</span>,mar<span class='op'>=</span><span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>3</span>,<span class='fl'>3</span>,<span class='fl'>3</span>,<span class='fl'>1</span><span class='op'>)</span>,mgp<span class='op'>=</span><span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>2</span>,<span class='fl'>1</span>,<span class='fl'>0</span><span class='op'>)</span><span class='op'>)</span></span>
<span class='r-in'><span class='va'>pnames</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"T1"</span>,<span class='st'>"MT"</span>,<span class='st'>"PD"</span>,<span class='st'>"R2star"</span><span class='op'>)</span></span>
<span class='r-in'><span class='va'>modelCoeff</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/pkg/awsMethods/man/extract-methods.html'>extract</a></span><span class='op'>(</span><span class='va'>modelMPM</span>,<span class='st'>"modelCoeff"</span><span class='op'>)</span></span>
<span class='r-in'><span class='kw'>for</span><span class='op'>(</span><span class='va'>i</span> <span class='kw'>in</span> <span class='fl'>1</span><span class='op'>:</span><span class='fl'>4</span><span class='op'>)</span><span class='op'>{</span></span>
<span class='r-in'>   <span class='fu'><a href='https://rdrr.io/pkg/adimpro/man/rimage.html'>rimage</a></span><span class='op'>(</span><span class='va'>modelCoeff</span><span class='op'>[</span><span class='va'>i</span>,,<span class='fl'>11</span>,<span class='op'>]</span><span class='op'>)</span></span>
<span class='r-in'>   <span class='fu'><a href='https://rdrr.io/r/graphics/title.html'>title</a></span><span class='op'>(</span><span class='va'>pnames</span><span class='op'>[</span><span class='va'>i</span><span class='op'>]</span><span class='op'>)</span></span>
<span class='r-in'>   <span class='op'>}</span></span>
<span class='r-in'><span class='va'>modelCoeff</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/pkg/awsMethods/man/extract-methods.html'>extract</a></span><span class='op'>(</span><span class='va'>modelMPMsp1</span>,<span class='st'>"modelCoeff"</span><span class='op'>)</span></span>
<span class='r-in'><span class='kw'>for</span><span class='op'>(</span><span class='va'>i</span> <span class='kw'>in</span> <span class='fl'>1</span><span class='op'>:</span><span class='fl'>4</span><span class='op'>)</span><span class='op'>{</span></span>
<span class='r-in'>   <span class='fu'><a href='https://rdrr.io/pkg/adimpro/man/rimage.html'>rimage</a></span><span class='op'>(</span><span class='va'>modelCoeff</span><span class='op'>[</span><span class='va'>i</span>,,<span class='fl'>11</span>,<span class='op'>]</span><span class='op'>)</span></span>
<span class='r-in'>   <span class='fu'><a href='https://rdrr.io/r/graphics/title.html'>title</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/paste.html'>paste</a></span><span class='op'>(</span><span class='st'>"smoothed"</span>,<span class='va'>pnames</span><span class='op'>[</span><span class='va'>i</span><span class='op'>]</span><span class='op'>)</span><span class='op'>)</span></span>
<span class='r-in'>   <span class='op'>}</span></span>
<span class='r-in'><span class='op'>}</span></span>
<span class='r-plt'><img src='smoothESTATICS-1.png' alt='' width='700' height='433' /></span>
<span class='r-in'><span class='fu'><a href='https://rdrr.io/r/graphics/par.html'>par</a></span><span class='op'>(</span><span class='va'>oldpar</span><span class='op'>)</span></span>
<span class='r-in'><span class='co'># }</span></span>
</code></pre></div>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top">
      <h2 data-toc-skip>Contents</h2>
    </nav>
  </div>
</div>


      <footer>
      <div class="copyright">
  <p><p>Developed by Joerg Polzehl, Karsten Tabelow, WIAS Berlin.</p></p>
</div>

<div class="pkgdown">
  <p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 1.6.1.9001.</p></p>
</div>

      </footer>
   </div>

  


  

  </body>
</html>


